% !TEX TS-program = xelatex
% !TEX encoding = UTF-8 Unicode

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FCUP Masters/Doctoral thesis book cover
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[11pt]{article}


% GRAPHICS FOLDER SETUP
\usepackage{graphicx}
\usepackage{eso-pic}
\usepackage{xcolor}
\graphicspath{{msc/},{logos/}}


% STARTING GEOMETRY
\usepackage[a2paper]{geometry}
\geometry{
	paperwidth=435mm,
	paperheight=297mm,
	top=0in,
	left=0in,
	right=0in,
	bottom=0in
}


% FONT DIR AND ARIAL FONT SETUP
\usepackage{rotating}
\usepackage[utf8]{inputenc}
\usepackage{setspace}
\setstretch{1.2}
\usepackage{fontspec}
\setmainfont[
	Path={fonts/},
	UprightFont=*-Regular,
	ItalicFont=*-Italic,
	BoldFont=*-Bold,
	BoldItalicFont=*-Bold-Italic
]{Arial}


% NEW FONT SIZE FOR TITLE
\makeatletter
\newcommand\HUGE{\@setfontsize\Huge{36}{43.2}}
\newcommand\HugeA{\@setfontsize\Huge{24}{28.8}}
\newcommand\LargeA{\@setfontsize\Large{18}{21.6}}
\makeatother


%----------------------------------------------------------------------------------------
%	DOCUMENT VARIABLES
%----------------------------------------------------------------------------------------

\input{vars}

\definecolor{fcupblue}{RGB}{153,205,255}

\newcommand\FrontCover{
    \put(-3,0){
    \parbox[b][\paperheight]{\paperwidth}{%
    \vfill
	\raggedleft
    \includegraphics[scale=1,page=3]{main.pdf}
    \vfill
}}}

\newcommand\BackCover{
    \put(-3,0){
    \parbox[b][\paperheight]{\paperwidth}{%
    \vfill
	\raggedright
    \includegraphics[scale=1,page=4]{main.pdf}
    \vfill
}}}

\newcommand\BlueRibbon{
    \put(-3,0){
    \parbox[b][\paperheight][t]{\paperwidth}{%
	\centering
	\vspace{19mm}
	\hspace{14mm}
	\fcolorbox{white}{fcupblue}{%
		\begin{minipage}[c][10mm][c]{39mm}
			\centering \bfseries \small \color{white}
			2ยบ \\ CICLO
		\end{minipage}
	}%
}}}

%----------------------------------------------------------------------------------------
%	BOOK COVER PAGE
%----------------------------------------------------------------------------------------

\begin{document}

\pagestyle{empty}

\AddToShipoutPicture*{\BackCover}
\AddToShipoutPicture*{\FrontCover}
\AddToShipoutPicture*{\BlueRibbon}

\hspace{210mm}
\begin{minipage}[c][297mm][t]{15mm}
	\centering

	\vspace{1mm}
	\begin{turn}{-90} 
		\parbox[t]{31mm}{
			\raggedright
			\HugeA MSc
		}
	\end{turn}

	\setstretch{1.0} 
	\small FCUP \\ \the\year

	\vspace{12.5mm}
	\includegraphics[width=8mm]{up}
	\vspace{12.5mm}

	\begin{turn}{-90} 
		\parbox[t]{100mm}{
			\setstretch{1.0} \raggedright
			\normalsize \bfseries \spinetitle
		}
	\end{turn}

	\vfill

	\begin{turn}{-90} 
		\parbox[t]{60mm}{
			\setstretch{1.0} \raggedright
			\small \bfseries \authorname
		}
	\end{turn}

	\vspace{4mm}
	\includegraphics[width=8mm]{fc}
	\vspace{4mm}
\end{minipage}

\end{document}