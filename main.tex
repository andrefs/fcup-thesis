% !TEX TS-program = xelatex
% !TEX encoding = UTF-8 Unicode

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FCUP Masters/Doctoral thesis title/examiner pages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[11pt]{article}


% ENCODING/ SPECIAL CHARACTERS
\usepackage[utf8]{inputenc}


% GRAPHICAL PACKAGES
\usepackage{graphicx}
\usepackage{eso-pic}
\usepackage{rotating}
\usepackage{xcolor}


% STARTING GEOMETRY
\usepackage[a4paper]{geometry}
\geometry{
	top=0mm,
	outer=0mm,
	inner=0mm,
	bottom=0mm
}


% LINESPREAD
\usepackage{calc}
\usepackage{setspace}
\setstretch{1.2}


% FONT DIR AND ARIAL FONT SETUP (XELATEX NEEDED)
\usepackage{fontspec}
\setmainfont[
	Path={fonts/},
	UprightFont=*-Regular,
	ItalicFont=*-Italic,
	BoldFont=*-Bold,
	BoldItalicFont=*-Bold-Italic
]{Arial}


% NEW FONT SIZES FOR TITLE
\makeatletter
\newcommand\HUGE{\@setfontsize\Huge{36}{43.2}}
\newcommand\HugeA{\@setfontsize\Huge{24}{28.8}}
\newcommand\LargeA{\@setfontsize\Large{18}{21.6}}
\makeatother



%----------------------------------------------------------------------------------------
%	DOCUMENT VARIABLES
%----------------------------------------------------------------------------------------

\newlength{\spinew}
\newlength{\coverwidth}
\newlength{\coverheight}
\setlength{\coverheight}{297mm}

\newcommand{\spinewidth}[1]{
	\setlength{\spinew}{#1}
	\setlength{\coverwidth}{420mm + \spinew}
}
\spinewidth{15mm}


\graphicspath{{msc/},{logos/}}



%----------------------------------------------------------------------------------------
%	START DOCUMENT
%----------------------------------------------------------------------------------------

\input{vars}

\begin{document}

\pagestyle{empty}
\setlength{\parindent}{0cm}



%----------------------------------------------------------------------------------------
%	ONE-SIDED TITLE PAGE
%----------------------------------------------------------------------------------------


\hspace{25mm}
\begin{minipage}[b][297mm][t]{125mm}
	\vfill
	\parbox[t][200mm][t]{125mm}{
		\raggedright
		\setstretch{2.6}
		{\HUGE \bfseries \fronttitle} \\
		\setstretch{1.2} {\large~\\}
		{\LargeA \authorname \\} 
		{\large \coursename \\}
		{\small \deptname \\ \the\year \\}
		{\small~\\}
		{\large \bfseries Orientador \\}
		{\small \supervisor \\}
		{\small~\\}
		{\large \bfseries Coorientador \\}
		{\small \cosupervisor}
	}
\end{minipage}
\hfill
\begin{minipage}[b][297mm][b]{54.3mm}
	\includegraphics[scale=0.97]{title}
\end{minipage}

\newpage



%----------------------------------------------------------------------------------------
%	EXAMINER PAGE
%----------------------------------------------------------------------------------------


\raggedleft
\begin{minipage}[b][297mm][b]{54.3mm}
	\setstretch{1.2}
	\includegraphics[width=52mm]{fcup}

	
	{ \noindent\footnotesize Todas as correções determinadas \\
		pelo júri, e só essas, foram efetuadas. \\
		\\
		O Presidente do Júri, \\
		\\ 
		\\
		\\
		Porto, \underline{\qquad\quad}/\underline{\quad\qquad}/\underline{\qquad\qquad} \\
	}


	\includegraphics[scale=0.97]{title}
\end{minipage}

\newpage



%----------------------------------------------------------------------------------------
%	BOOK FRONT COVER PAGE
%----------------------------------------------------------------------------------------


\newcommand\FrontCover{
    \put(0,0){\parbox[b][\coverheight]{\coverwidth}{
		\raggedleft\parbox[b][\coverheight]{210mm}{% FRONT STARTS HERE
			\raggedleft \hspace{25mm}
			\begin{minipage}[b][\coverheight][t]{125mm}
				\parbox[t]{125mm}{
					\raggedleft
					\vspace{19mm}
					
					\includegraphics[width=52mm]{fcup}\hspace{19mm}

					% \vspace{3mm}
					% \includegraphics[width=52mm]{fcup}\hspace{19mm}

					% \vspace{3mm}
					% \includegraphics[width=52mm]{fcup}\hspace{19mm}

					% ADD EXTRA LOGO FUNCTIONALITY
				}
				\vfill
				\parbox[t][175mm][t]{125mm}{
					\raggedright
					\setstretch{2.6}
					{\HUGE \bfseries \fronttitle} \\
					\setstretch{1.2} {\large~\\}
					{\LargeA \authorname \\} 
					{\large Dissertação de \ttype~apresentada à \\}
					{\large Faculdade de Ciências da Universidade do Porto em \\}
					{\large \fieldname \\}
					{\LargeA \the\year \\}
				}
			\end{minipage}
			\hfill
			\begin{minipage}[b][\coverheight][b]{54.3mm}
				\includegraphics[scale=0.97]{front}
			\end{minipage}
		}
	}} % FRONT STOPS HERE
}



%----------------------------------------------------------------------------------------
%	BOOK BACK COVER PAGE
%----------------------------------------------------------------------------------------


\newcommand\BackCover{
    \put(0,0){\parbox[b][\coverheight]{\coverwidth}{% BACK STARTS HERE
		\raggedright
		\begin{minipage}[b][\coverheight][b]{54.3mm}
			\raggedleft
			\includegraphics[width=52mm]{fcup}
			~\\[8mm]
			\includegraphics[scale=0.97]{back}
		\end{minipage}
	}}% BACK ENDS HERE
}



%----------------------------------------------------------------------------------------
%	BOOK SPINE/RIBBON 
%----------------------------------------------------------------------------------------


\newcommand\BlueRibbon{
    \put(0,0){
    \parbox[b][\coverheight][t]{\coverwidth}{% RIBBON BEGINS HERE
	\centering
	\vspace{19mm}
	\fcolorbox{white}{fcupblue}{%
		\begin{minipage}[c][10mm][c]{2.6\spinew}
			\centering \bfseries \small \color{white}
			2º \\ CICLO
		\end{minipage}
	}% RIBBON ENDS HERE
}}}


\newcommand\Spine{
    \put(0,0){\parbox[b][\coverheight][t]{\coverwidth}{% SPINE BEGINS HERE
		\hspace{210mm} 
		\begin{minipage}[c][\coverheight][t]{\spinew}
			\centering

			\vspace{1mm}
			\begin{turn}{-90} 
				\parbox[t]{31mm}{
					\raggedright
					\HugeA MSc
				}
			\end{turn}

			\setstretch{1.0} 
			\small FCUP \\ \the\year

			\vspace{12.5mm}
			\includegraphics[width=0.6\spinew]{up}
			\vspace{12.5mm}

			\begin{turn}{-90} 
				\parbox[t]{100mm}{
					\setstretch{1.0} \raggedright
					\normalsize \bfseries \spinetitle
				}
			\end{turn}

			\vfill

			\begin{turn}{-90} 
				\parbox[t]{60mm}{
					\setstretch{1.0} \raggedright
					\small \bfseries \authorname
				}
			\end{turn}

			\vspace{4mm}
			\includegraphics[width=0.6\spinew]{fc}
			\vspace{4mm}
		\end{minipage}
	}} % SPINE ENDS HERE
}



%----------------------------------------------------------------------------------------
%	BOOK COVER ASSEMBLY
%----------------------------------------------------------------------------------------


\eject \pdfpagewidth=\coverwidth \pdfpageheight=\coverheight

\newpage

\AddToShipoutPicture*{\BackCover}
\AddToShipoutPicture*{\FrontCover}
\AddToShipoutPicture*{\BlueRibbon}
\AddToShipoutPicture*{\Spine}

\phantom{~}



\end{document}